// Internet-facing baseline configuration
//
// Goals:
// - Use the built-in "public" security profile defaults
// - Prefer TLS client connections
// - Keep S2S disabled unless you run a network
// - Keep operational HTTP bound to localhost
//
// NOTE: This file includes the modular conf blocks from IRCd.Server.

security {
	profile = "public";
};

// Server identity (edit these)
serverinfo {
	name = "irc.example.net";
	sid = "001";
	description = "Example IRC Server";
	network = "ExampleNet";
	version = "UnrealBG-IRCd";
	adminLocation1 = "Example";
	adminLocation2 = "Network Administration";
	adminEmail = "admin@example.net";
};

// Core modular blocks
include "../../IRCd.Server/confs/isupport.conf";
include "../../IRCd.Server/confs/transport.conf";
include "../../IRCd.Server/confs/flood.conf";
include "../../IRCd.Server/confs/auth.conf";
include "../../IRCd.Server/confs/limits.conf";
include "../../IRCd.Server/confs/bans.conf";
include "../../IRCd.Server/confs/connectionguard.conf";
include "../../IRCd.Server/confs/connectionprecheck.conf";
include "../../IRCd.Server/confs/ratelimit.conf";
include "../../IRCd.Server/confs/autodline.conf";
include "../../IRCd.Server/confs/sasl.conf";
include "../../IRCd.Server/confs/ping.conf";
include "../../IRCd.Server/confs/opersecurity.conf";
include "../../IRCd.Server/confs/services.conf";
include "../../IRCd.Server/confs/links.conf";

// Operator classes and accounts
include "../../IRCd.Server/confs/classes.conf";
include "../../IRCd.Server/confs/opers.conf";

// MOTD + vhost MOTDs
include "../../IRCd.Server/confs/motd.conf";

// Listener configuration
// - `clientport = 0` disables plaintext IRC.
// - `serverport = 0` disables S2S listener.
listen {
	bind = "0.0.0.0";

	// Prefer TLS-only for public deployment
	clientport = 0;

	enabletls = true;
	tlsclientport = 6697;

	// Needed for SASL EXTERNAL (optional)
	requestclientcertificate = true;

	// For initial deployment you can auto-generate a self-signed certificate.
	// For production, replace with a real certificate and set autogenerate=false.
	tlscertificatepath = "";
	tlscertificatepassword = "";
	autogenerateselfsignedcertificate = true;
	autogeneratedcertpath = "certs/auto-generated.pfx";
	autogeneratedcertpassword = "ChangeMe";
	autogeneratedcertdaysvalid = 365;
	autogeneratedcertcommonname = "irc.example.net";

	// S2S disabled by default (enable only if you run a network)
	serverport = 0;
};

// Operational HTTP endpoints (recommended on localhost)
observability {
	enabled = true;
	bind = "127.0.0.1";
	port = 6060;
};

// Strongly recommended for production
opersecurity {
	require_hashed_passwords = true;
};
