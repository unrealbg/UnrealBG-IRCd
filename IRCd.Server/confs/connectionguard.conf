connectionguard {
    enabled = true;

    # Connection burst protection (per IP)
    maxConnectionsPerWindowPerIp = 3;
    # TLS connections can be bucketed separately
    maxConnectionsPerWindowPerIpTls = 3;
    # Limit TLS handshakes as well (before AuthenticateAsServerAsync)
    maxTlsHandshakesPerWindowPerIp = 3;
    windowSeconds = 5;

    # Optional global cap (across all IPs). 0 = disabled.
    globalMaxActiveConnections = 0;

    # Concurrent connections (per IP)
    maxActiveConnectionsPerIp = 5;

    # Unregistered clients allowed per IP
    maxUnregisteredPerIp = 3;

    # Registration timeout (seconds)
    registrationTimeoutSeconds = 30;

    # TLS handshake timeout (seconds)
    tlsHandshakeTimeoutSeconds = 10;

    rejectMessage = "Too many connections from your IP. Please try again later.";
}
