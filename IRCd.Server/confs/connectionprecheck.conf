connectionprecheck {
    # Optional pre-connect checks (DNSBL/RBL + Tor/VPN heuristics)
    # Default: disabled (no overhead).
    enabled = false;

    # Per-connection overall timeout budget for all prechecks.
    timeoutMs = 300;

    # Result cache (per remote IP). Separate TTLs for allow vs block.
    cacheAllowTtlSeconds = 60;
    cacheBlockTtlSeconds = 300;
    cacheMaxEntries = 50000;

    # Recommended: skip RFC1918/loopback/link-local.
    skipNonPublicIps = true;

    # General DNSBL/RBL zones (standard reverse-IP DNSBL format).
    # dnsbl {
    #     zone = "dnsbl.example";
    #     reason = "Listed";
    #     # If > 0, add a temporary DLINE for the exact IP on hit.
    #     tempDlineSeconds = 300;
    # }

    # Tor-related zones (also reverse-IP DNSBL format).
    # tor_dnsbl {
    #     zone = "tor.example";
    #     reason = "Tor exit";
    #     tempDlineSeconds = 0;
    # }

    # VPN/proxy-related zones (also reverse-IP DNSBL format).
    # vpn_dnsbl {
    #     zone = "vpn.example";
    #     reason = "VPN/proxy";
    #     tempDlineSeconds = 0;
    # }
}
