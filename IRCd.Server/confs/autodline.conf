// Automatic temporary DLINE escalation (AutoDLINE)
//
// When enabled, repeated rate-limit/flood hits from the same IP will
// trigger a temporary DLINE with exponential backoff.
//
// Notes:
// - Disabled by default.
// - Opers/services are exempt.
// - Use whitelist CIDRs for trusted monitoring, bouncers, and known NATs.
//
// Internet-facing suggestion (public profile):
// - Start conservative to avoid false positives for NATed users.
// - Example:
//     enabled = true;
//     windowSeconds = 60;
//     threshold = 8;
//     baseDurationSeconds = 120;
//     backoffFactor = 2;
//     maxDurationSeconds = 7200;
//     whitelist = "127.0.0.1/32,::1/128";

autodline {
    enabled = false;

    // Offense score window; score resets if no offenses arrive in this window.
    windowSeconds = 60;

    // Number of offenses within the window required to apply a DLINE.
    threshold = 10;

    // Initial DLINE duration (seconds).
    baseDurationSeconds = 60;

    // Exponential backoff multiplier per strike (integer).
    backoffFactor = 2;

    // Maximum DLINE duration (seconds).
    maxDurationSeconds = 3600;

    // Comma-separated list of IP/CIDR masks exempt from AutoDLINE.
    // Example: "192.0.2.0/24,2001:db8::/32"
    whitelist = "";
};
